___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Exoclick by Stape",
  "categories": [
    "AFFILIATE_MARKETING",
    "ADVERTISING",
    "CONVERSIONS"
  ],
  "brand": {
    "id": "brand_dummy",
    "displayName": "stape.io",
    "thumbnail": "data:image/png;base64,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\u003d"
  },
  "description": "Exoclick server-to-server (S2S) conversion tracking.",
  "containerContexts": [
    "SERVER"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "GROUP",
    "name": "conversionGroup",
    "subParams": [
      {
        "type": "SELECT",
        "name": "useOptimisticScenario",
        "displayName": "Use Optimistic Scenario",
        "macrosInSelect": true,
        "selectItems": [
          {
            "value": true,
            "displayValue": "true"
          },
          {
            "value": false,
            "displayValue": "false"
          }
        ],
        "simpleValueType": true,
        "help": "The tag will call gtmOnSuccess() without waiting for a response from the API. This will speed up sGTM response time however your tag will always return the status fired successfully even in case it is not.",
        "defaultValue": false
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "tagExecutionConsentSettingsGroup",
    "displayName": "Tag Execution Consent Settings",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "RADIO",
        "name": "adStorageConsent",
        "radioItems": [
          {
            "value": "optional",
            "displayValue": "Send data always"
          },
          {
            "value": "required",
            "displayValue": "Send data in case marketing consent given",
            "help": "Aborts the tag execution if marketing consent (\u003ci\u003ead_storage\u003c/i\u003e Google Consent Mode or Stape\u0027s Data Tag parameter) is not given."
          }
        ],
        "simpleValueType": true,
        "defaultValue": "optional"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "logsGroup",
    "displayName": "Logs Settings",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "RADIO",
        "name": "logType",
        "radioItems": [
          {
            "value": "no",
            "displayValue": "Do not log"
          },
          {
            "value": "debug",
            "displayValue": "Log to console during debug and preview"
          },
          {
            "value": "always",
            "displayValue": "Always log to console"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "debug"
      }
    ],
    "enablingConditions": []
  },
  {
    "displayName": "BigQuery Logs Settings",
    "name": "bigQueryLogsGroup",
    "groupStyle": "ZIPPY_CLOSED",
    "type": "GROUP",
    "subParams": [
      {
        "type": "RADIO",
        "name": "bigQueryLogType",
        "radioItems": [
          {
            "value": "no",
            "displayValue": "Do not log to BigQuery"
          },
          {
            "value": "always",
            "displayValue": "Log to BigQuery"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "no"
      },
      {
        "type": "GROUP",
        "name": "logsBigQueryConfigGroup",
        "groupStyle": "NO_ZIPPY",
        "subParams": [
          {
            "type": "TEXT",
            "name": "logBigQueryProjectId",
            "displayName": "BigQuery Project ID",
            "simpleValueType": true,
            "help": "Optional.  \u003cbr/\u003e\u003cbr/\u003e  If omitted, it will be retrieved from the environment variable \u003cI\u003eGOOGLE_CLOUD_PROJECT\u003c/i\u003e where the server container is running. If the server container is running on Google Cloud, \u003cI\u003eGOOGLE_CLOUD_PROJECT\u003c/i\u003e will already be set to the Google Cloud project\u0027s ID."
          },
          {
            "type": "TEXT",
            "name": "logBigQueryDatasetId",
            "displayName": "BigQuery Dataset ID",
            "simpleValueType": true,
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          },
          {
            "type": "TEXT",
            "name": "logBigQueryTableId",
            "displayName": "BigQuery Table ID",
            "simpleValueType": true,
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          }
        ],
        "enablingConditions": [
          {
            "paramName": "bigQueryLogType",
            "paramValue": "always",
            "type": "EQUALS"
          }
        ]
      }
    ],
    "enablingConditions": []
  }
]


___SANDBOXED_JS_FOR_SERVER___

const BigQuery = require('BigQuery');
const encodeUriComponent = require('encodeUriComponent');
const getAllEventData = require('getAllEventData');
const getContainerVersion = require('getContainerVersion');
const getCookieValues = require('getCookieValues');
const getRequestHeader = require('getRequestHeader');
const getTimestampMillis = require('getTimestampMillis');
const getType = require('getType');
const JSON = require('JSON');
const logToConsole = require('logToConsole');
const makeInteger = require('makeInteger');
const makeString = require('makeString');
const sendHttpRequest = require('sendHttpRequest');

/*==============================================================================
==============================================================================*/

const eventData = getAllEventData();


if (data.useOptimisticScenario) {
  return data.gtmOnSuccess();
}

/*==============================================================================
  Vendor related functions
==============================================================================*/



/*==============================================================================
  Helpers
==============================================================================*/

function getUrl(eventData) {
  return eventData.page_location || eventData.page_referrer || getRequestHeader('referer');
}

function isUIFieldTrue(field) {
  return [true, 'true', 1, '1'].indexOf(field) !== -1;
}

function isValidValue(value) {
  const valueType = getType(value);
  return valueType !== 'null' && valueType !== 'undefined' && value !== '';
}

function enc(data) {
  if (data === undefined || data === null) data = '';
  return encodeUriComponent(makeString(data));
}

function isConsentGivenOrNotRequired(data, eventData) {
  if (data.adStorageConsent !== 'required') return true;
  if (eventData.consent_state) return !!eventData.consent_state.ad_storage;
  const xGaGcs = eventData['x-ga-gcs'] || ''; // x-ga-gcs is a string like "G110"
  return xGaGcs[2] === '1';
}

function log(rawDataToLog) {
  const logDestinationsHandlers = {};
  if (determinateIsLoggingEnabled()) logDestinationsHandlers.console = logConsole;
  if (determinateIsLoggingEnabledForBigQuery()) logDestinationsHandlers.bigQuery = logToBigQuery;

  rawDataToLog.TraceId = getRequestHeader('trace-id');

  const keyMappings = {
    // No transformation for Console is needed.
    bigQuery: {
      Name: 'tag_name',
      Type: 'type',
      TraceId: 'trace_id',
      EventName: 'event_name',
      RequestMethod: 'request_method',
      RequestUrl: 'request_url',
      RequestBody: 'request_body',
      ResponseStatusCode: 'response_status_code',
      ResponseHeaders: 'response_headers',
      ResponseBody: 'response_body'
    }
  };

  for (const logDestination in logDestinationsHandlers) {
    const handler = logDestinationsHandlers[logDestination];
    if (!handler) continue;

    const mapping = keyMappings[logDestination];
    const dataToLog = mapping ? {} : rawDataToLog;

    if (mapping) {
      for (const key in rawDataToLog) {
        const mappedKey = mapping[key] || key;
        dataToLog[mappedKey] = rawDataToLog[key];
      }
    }

    handler(dataToLog);
  }
}

function logConsole(dataToLog) {
  logToConsole(JSON.stringify(dataToLog));
}

function logToBigQuery(dataToLog) {
  const connectionInfo = {
    projectId: data.logBigQueryProjectId,
    datasetId: data.logBigQueryDatasetId,
    tableId: data.logBigQueryTableId
  };

  dataToLog.timestamp = getTimestampMillis();

  ['request_body', 'response_headers', 'response_body'].forEach((p) => {
    dataToLog[p] = JSON.stringify(dataToLog[p]);
  });

  BigQuery.insert(connectionInfo, [dataToLog], { ignoreUnknownValues: true });
}

function determinateIsLoggingEnabled() {
  const containerVersion = getContainerVersion();
  const isDebug = !!(
    containerVersion &&
    (containerVersion.debugMode || containerVersion.previewMode)
  );

  if (!data.logType) {
    return isDebug;
  }

  if (data.logType === 'no') {
    return false;
  }

  if (data.logType === 'debug') {
    return isDebug;
  }

  return data.logType === 'always';
}

function determinateIsLoggingEnabledForBigQuery() {
  if (data.bigQueryLogType === 'no') return false;
  return data.bigQueryLogType === 'always';
}


___SERVER_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "read_request",
        "versionId": "1"
      },
      "param": [
        {
          "key": "headerWhitelist",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "trace-id"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "referer"
                  }
                ]
              }
            ]
          }
        },
        {
          "key": "headersAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "requestAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "headerAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "queryParameterAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "cookieAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "cookieNames",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "eff_cid"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "all"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_container_data",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_event_data",
        "versionId": "1"
      },
      "param": [
        {
          "key": "eventDataAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_http",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://track.effiliation.com/servlet/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_bigquery",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedTables",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "projectId"
                  },
                  {
                    "type": 1,
                    "string": "datasetId"
                  },
                  {
                    "type": 1,
                    "string": "tableId"
                  },
                  {
                    "type": 1,
                    "string": "operation"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: '[Page View] Tag is not executed when Tag Execution Consent is Denied'
  code: |-
    setGetAllEventData({
      'x-ga-gcs': 'G100'
    });
    setAllMockDataByEventType('pageView', {
      adStorageConsent: 'required'
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
    assertApi('getCookieValues').wasNotCalled();
    assertApi('setCookie').wasNotCalled();
    assertApi('sendHttpRequest').wasNotCalled();
- name: '[Page View] Click ID cookie is NOT set if URL doesn''t contain it'
  code: |-
    setAllMockDataByEventType('pageView');

    mock('getAllEventData', {
      page_location: 'https://example.com/'
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
    assertApi('setCookie').wasNotCalled();
- name: '[Page View] Click ID cookie is set if URL contains it'
  code: |-
    setAllMockDataByEventType('pageView');

    const expectedCookieOptions = {
      domain: 'auto',
      samesite: 'none',
      path: '/',
      secure: true,
      httpOnly: false,
      'max-age': 2592000
    };

    mock('getAllEventData', {
      page_location: 'https://example.com/?utm_source=effinity&eff_cpt=eff_cptValue&eff_sub1=eff_sub1Value&eff_sub2=eff_sub2Value&eff_pid=eff_pidValue&eff_pcid=eff_pcidValue&eff_pcuid=eff_pcuidValue&eff_pr1=eff_pr1Value'
    });

    mock('setCookie', () => {
      const cookieName = arguments[0];
      const cookieValue = arguments[1];
      const cookieOptions = arguments[2];
      const noEncode = arguments[3];
      assertThat(cookieName).isEqualTo('eff_cid');
      assertThat(JSON.parse(cookieValue)).isEqualTo({
        id_compteur: 'eff_cptValue',
        effi_id: 'eff_sub1Value',
        effi_id2: 'eff_sub2Value',
        prod_id: 'eff_pidValue',
        effi_pcid: 'eff_pcidValue',
        effi_pcuid: 'eff_pcuidValue',
        effi_param1: 'eff_pr1Value'
      });
      assertThat(cookieOptions).isEqualTo(expectedCookieOptions);
      assertThat(noEncode).isFalse();
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
- name: '[Page View] Click ID Cookie settings are overwritten'
  code: |-
    const cookieDomain = 'example.com';
    const cookieHttpOnly = false;
    const maxAgeDays = 1;

    const expectedOverwrittenCookieOptions = {
      domain: cookieDomain,
      samesite: 'lax',
      path: '/',
      secure: true,
      httpOnly: cookieHttpOnly,
      'max-age': 60 * 60 * 24 * maxAgeDays
    };

    setAllMockDataByEventType('pageView', {
      cookieDomain: cookieDomain,
      cookieSameSite: 'lax',
      cookieExpiration: maxAgeDays,
      cookieHttpOnly: cookieHttpOnly
    });

    mock('getAllEventData', {
      page_location: 'https://example.com/?utm_source=effinity&eff_cpt=eff_cptValue&eff_sub1=eff_sub1Value&eff_sub2=eff_sub2Value&eff_pid=eff_pidValue&eff_pcid=eff_pcidValue&eff_pcuid=eff_pcuidValue&eff_pr1=eff_pr1Value'});

    mock('setCookie', () => {
      const cookieName = arguments[0];
      const cookieValue = arguments[1];
      const cookieOptions = arguments[2];
      const noEncode = arguments[3];
      assertThat(cookieName).isEqualTo('eff_cid');
      assertThat(JSON.parse(cookieValue)).isEqualTo({
        id_compteur: 'eff_cptValue',
        effi_id: 'eff_sub1Value',
        effi_id2: 'eff_sub2Value',
        prod_id: 'eff_pidValue',
        effi_pcid: 'eff_pcidValue',
        effi_pcuid: 'eff_pcuidValue',
        effi_param1: 'eff_pr1Value'
      });
      assertThat(cookieOptions).isEqualTo(expectedOverwrittenCookieOptions);
      assertThat(noEncode).isFalse();
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
- name: '[Conversion] Tag is not executed when Tag Execution Consent is Denied'
  code: |-
    setGetAllEventData({
      'x-ga-gcs': 'G100'
    });
    setAllMockDataByEventType('conversion_sale', {
      adStorageConsent: 'required'
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
    assertApi('getCookieValues').wasNotCalled();
    assertApi('setCookie').wasNotCalled();
    assertApi('sendHttpRequest').wasNotCalled();
- name: '[Conversion Lead] Request is not sent if required parameters are missing'
  code: "const originalMockData = setAllMockDataByEventType('conversion_lead');\n\n\
    [\n  { consentPerformance: undefined },\n  { effinityId: undefined },\n  { idCompteur:\
    \ undefined },\n  { orderOrLeadId: undefined }\n].forEach((scenario) => {\n  const\
    \ copyMockData = JSON.parse(JSON.stringify(originalMockData));\n  mergeObj(copyMockData,\
    \ scenario);\n  \n  runCode(copyMockData);\n  \n  assertApi('sendHttpRequest').wasNotCalled();\n\
    \  assertApi('gtmOnSuccess').wasNotCalled();\n  assertApi('gtmOnFailure').wasCalled();\n\
    });\n"
- name: '[Conversion Sale] Request is not sent if required parameters are missing'
  code: "const originalMockData = setAllMockDataByEventType('conversion_sale');\n\n\
    [\n  { consentPerformance: undefined },\n  { effinityId: undefined },\n  { idCompteur:\
    \ undefined },\n  { orderOrLeadId: undefined },\n  { currency: undefined },\n\
    \  { value: undefined },\n  { voucher: undefined }\n].forEach((scenario) => {\n\
    \  const copyMockData = JSON.parse(JSON.stringify(originalMockData));\n  mergeObj(copyMockData,\
    \ scenario);\n  \n  runCode(copyMockData);\n  \n  assertApi('sendHttpRequest').wasNotCalled();\n\
    \  assertApi('gtmOnSuccess').wasNotCalled();\n  assertApi('gtmOnFailure').wasCalled();\n\
    });\n"
- name: '[Conversion Lead] Request Base URL is correctly built'
  code: |-
    setAllMockDataByEventType('conversion_lead');

    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      const parsedUrl = parseUrl(requestUrl);
      assertThat(parsedUrl.origin + parsedUrl.pathname).isEqualTo('https://track.effiliation.com/servlet/effi.leadmobile');
      callback(200);
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
- name: '[Conversion Sale] Request Base URL is correctly built'
  code: |-
    setAllMockDataByEventType('conversion_sale');

    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      const parsedUrl = parseUrl(requestUrl);
      assertThat(parsedUrl.origin + parsedUrl.pathname).isEqualTo('https://track.effiliation.com/servlet/effi.revenuemobile');
      callback(200);
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
- name: '[Conversion] Request Options is correctly built'
  code: |-
    setAllMockDataByEventType('conversion_sale');

    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      assertThat(requestOptions).isEqualTo({
        method: 'GET'
      });
      callback(200);
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
- name: '[Conversion Lead] [Data from UI fields] Request is successfully built and
    sent'
  code: |-
    setAllMockDataByEventType('conversion_lead', {
      autoMapData: false
    });

    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      assertThat(requestUrl).isEqualTo('https://track.effiliation.com/servlet/effi.leadmobile?id=effinityId&origin=stape_s2s&ref=leadId&consent_performance=1&attrib=2&date=2025-12-31&ref2=123&id_compteur=eff_cpt&effi_id=eff_sub1&effi_id2=eff_sub2&prod_id=eff_pid&effi_pcid=eff_pcid&effi_pcuid=eff_pcuid&effi_param1=eff_pr1');
      callback(200);
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
- name: '[Conversion Lead] [Data from UI fields fallbacks] Request is successfully
    built and sent'
  code: |-
    setAllMockDataByEventType('conversion_lead', {
      autoMapData: true
    });

    ['orderOrLeadId', 'idCompteur', 'effiId', 'effiId2', 'prodId', 'effiPcid', 'effiPcuid', 'effiParam1'].forEach(p => Object.delete(mockData, p));

    setGetAllEventData();

    mock('getCookieValues', (cookieName) => {
      if (cookieName === 'eff_cid') {
        return [
          JSON.stringify({
            id_compteur: 'eff_cpt_from_cookie',
            effi_id: 'eff_sub1_from_cookie',
            effi_id2: 'eff_sub2_from_cookie',
            prod_id: 'eff_pid_from_cookie',
            effi_pcid: 'eff_pcid_from_cookie',
            effi_pcuid: 'eff_pcuid_from_cookie',
            effi_param1: 'eff_pr1_from_cookie'
          })
        ];
      }
      return [];
    });

    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      assertThat(requestUrl).isEqualTo('https://track.effiliation.com/servlet/effi.leadmobile?id=effinityId&origin=stape_s2s&ref=transactionId&consent_performance=1&attrib=2&date=2025-12-31&ref2=123&id_compteur=eff_cpt_from_cookie&effi_id=eff_sub1_from_cookie&effi_id2=eff_sub2_from_cookie&prod_id=eff_pid_from_cookie&effi_pcid=eff_pcid_from_cookie&effi_pcuid=eff_pcuid_from_cookie&effi_param1=eff_pr1_from_cookie');
      callback(200);
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
- name: '[Conversion Sale] [Data from UI fields] Request is successfully built and
    sent'
  code: |-
    setAllMockDataByEventType('conversion_sale', {
      autoMapData: false
    });

    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      assertThat(requestUrl).isEqualTo("https://track.effiliation.com/servlet/effi.revenuemobile?id=effinityId&origin=stape_s2s&ref=orderId&montant=value&monnaie=currency&voucher=voucher&payment=paymentype&newcustomer=1&cart_detail=%5B%7B%22id%22%3A%22SKU_12345%22%2C%22name%22%3A%22Stan%20and%20Friends%20Tee%22%2C%22price%22%3A10.01%2C%22quantity%22%3A3%7D%2C%7B%22id%22%3A%22SKU_12346%22%2C%22name%22%3A%22Google%20Grey%20Women's%20(Tee)%22%2C%22price%22%3A21.01%2C%22quantity%22%3A2%7D%5D&consent_performance=1&attrib=2&date=2025-12-31&ref2=123&id_compteur=eff_cpt&effi_id=eff_sub1&effi_id2=eff_sub2&prod_id=eff_pid&effi_pcid=eff_pcid&effi_pcuid=eff_pcuid&effi_param1=eff_pr1");
      callback(200);
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
- name: '[Conversion Sale] [Data from UI fields fallbacks] Request is successfully
    built and sent'
  code: |-
    setAllMockDataByEventType('conversion_sale', {
      autoMapData: true
    });

    ['orderOrLeadId', 'value', 'currency', 'voucher', 'paymentType', 'newCustomer', 'cart', 'idCompteur', 'effiId', 'effiId2', 'prodId', 'effiPcid', 'effiPcuid', 'effiParam1'].forEach(p => Object.delete(mockData, p));

    setGetAllEventData();

    mock('getCookieValues', (cookieName) => {
      if (cookieName === 'eff_cid') {
        return [
          JSON.stringify({
            id_compteur: 'eff_cpt_from_cookie',
            effi_id: 'eff_sub1_from_cookie',
            effi_id2: 'eff_sub2_from_cookie',
            prod_id: 'eff_pid_from_cookie',
            effi_pcid: 'eff_pcid_from_cookie',
            effi_pcuid: 'eff_pcuid_from_cookie',
            effi_param1: 'eff_pr1_from_cookie'
          })
        ];
      }
      return [];
    });

    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      assertThat(requestUrl).isEqualTo("https://track.effiliation.com/servlet/effi.revenuemobile?id=effinityId&origin=stape_s2s&ref=transactionId&montant=123.45&monnaie=BRL&voucher=coupon&payment=card&newcustomer=1&cart_detail=%5B%7B%22id%22%3A%22SKU_12345%22%2C%22name%22%3A%22Stan%20and%20Friends%20Tee%22%2C%22price%22%3A10.01%2C%22quantity%22%3A3%7D%2C%7B%22id%22%3A%22SKU_12346%22%2C%22name%22%3A%22Google%20Grey%20Women's%20(Tee)%22%2C%22price%22%3A21.01%2C%22quantity%22%3A2%7D%5D&consent_performance=1&attrib=2&date=2025-12-31&ref2=123&id_compteur=eff_cpt_from_cookie&effi_id=eff_sub1_from_cookie&effi_id2=eff_sub2_from_cookie&prod_id=eff_pid_from_cookie&effi_pcid=eff_pcid_from_cookie&effi_pcuid=eff_pcuid_from_cookie&effi_param1=eff_pr1_from_cookie");
      callback(200);
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
- name: '[Conversion] Failure handler is called if response status code is outside
    success range'
  code: |-
    setAllMockDataByEventType('conversion_sale');

    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      callback(500);
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasNotCalled();
    assertApi('gtmOnFailure').wasCalled();
- name: '[Logs] Should log to console'
  code: "const originalMockData = setAllMockDataByEventType('conversion_sale');\n\n\
    [\n  // if the 'Always log to console' option is selected\n  { mockData: { logType:\
    \ 'always' }, expectedDebugMode: true },\n  // if the 'Log during debug and preview'\
    \ option is selected AND is on preview mode\n  { mockData: { logType: 'debug'\
    \ }, expectedDebugMode: true },\n].forEach(scenario => {\n  const copyMockData\
    \ = JSON.parse(JSON.stringify(originalMockData));\n  mergeObj(copyMockData, scenario.mockData);\n\
    \  \n  mock('getContainerVersion', () => {\n    return {\n      debugMode: scenario.expectedDebugMode\n\
    \    };\n  }); \n  \n  mock('logToConsole', (logData) => {\n    const parsedLogData\
    \ = JSON.parse(logData);\n    requiredConsoleKeys.forEach(p => assertThat(parsedLogData[p]).isDefined());\n\
    \  });\n  \n  runCode(copyMockData);\n  \n  assertApi('logToConsole').wasCalled();\n\
    \  assertApi('gtmOnSuccess').wasCalled();\n  assertApi('gtmOnFailure').wasNotCalled();\n\
    });"
- name: '[Logs] Should NOT log to console'
  code: "const originalMockData = setAllMockDataByEventType('conversion_sale');\n\n\
    [\n  // if the 'Log during debug and preview' option is selected AND is NOT on\
    \ preview mode\n  { mockData: { logType: 'debug' }, expectedDebugMode: false },\n\
    \  // if the 'Do not log' option is selected\n  { mockData: { logType: 'no' },\
    \ expectedDebugMode: undefined },\n].forEach(scenario => {\n  const copyMockData\
    \ = JSON.parse(JSON.stringify(originalMockData));\n  mergeObj(copyMockData, scenario.mockData);\n\
    \  \n  mock('getContainerVersion', () => {\n    return {\n      debugMode: scenario.expectedDebugMode\n\
    \    };\n  });\n  \n  runCode(copyMockData);\n\n  assertApi('logToConsole').wasNotCalled();\n\
    \  assertApi('gtmOnSuccess').wasCalled();\n  assertApi('gtmOnFailure').wasNotCalled();\n\
    });"
- name: '[Logs] Should log to BQ, if the ''Log to BigQuery'' option is selected'
  code: "setAllMockDataByEventType('conversion_sale');\n\nmockData.bigQueryLogType\
    \ = 'always';\n\nmockObject('BigQuery', {\n  insert: (connectionInfo, rows, options)\
    \ => { \n    assertThat(connectionInfo).isDefined();\n    assertThat(rows).isArray();\n\
    \    assertThat(rows).hasLength(1);\n    requiredBqKeys.forEach(p => assertThat(rows[0][p]).isDefined());\n\
    \    assertThat(options).isEqualTo(expectedBqOptions);\n    return Promise.create((resolve,\
    \ reject) => {\n      resolve();\n    });\n  }\n});\n\nrunCode(mockData);\n\n\
    assertApi('gtmOnSuccess').wasCalled();\nassertApi('gtmOnFailure').wasNotCalled();\n"
- name: '[Logs] Should NOT log to BQ, if the ''Do not log to BigQuery'' option is
    selected'
  code: "setAllMockDataByEventType('conversion_sale');\n\nmockData.bigQueryLogType\
    \ = 'no';\n\n// assertApi doesn't work for 'BigQuery.insert()'.\n// Ref: https://gtm-gear.com/posts/gtm-templates-testing/\n\
    mockObject('BigQuery', {\n  insert: (connectionInfo, rows, options) => { \n  \
    \  fail('BigQuery.insert should not have been called.');\n    return Promise.create((resolve,\
    \ reject) => {\n      resolve();\n    });\n  }\n});\n\nrunCode(mockData);\n\n\
    assertApi('gtmOnSuccess').wasCalled();\nassertApi('gtmOnFailure').wasNotCalled();"
setup: "const JSON = require('JSON');\nconst Promise = require('Promise');\nconst\
  \ parseUrl = require('parseUrl');\nconst Object = require('Object');\n\nfunction\
  \ mergeObj(target, source) {\n  for (const key in source) {\n    if (source.hasOwnProperty(key))\
  \ target[key] = source[key];\n  }\n  return target;\n}\n\nconst setGetAllEventData\
  \ = (objToBeMerged) => {\n  mock('getAllEventData', mergeObj({\n    'x-ga-protocol_version':\
  \ '2',\n    'x-ga-measurement_id': 'G-123ABC',\n    'x-ga-gtm_version': '45je55e1za200',\n\
  \    'x-ga-page_id': 1747422523211,\n    'x-ga-gcd': '13l3l3l3l1l1',\n    'x-ga-npa':\
  \ '0',\n    'x-ga-dma': '0',\n    'x-ga-mp2-tag_exp':\n      '101509157~103116025~103130498~103130500~103136993~103136995~103200001~103207802~103211513~103233427~103252644~103252646~103263073~103301114~103301116',\n\
  \    client_id: 'AUJctU7H7hBB/aMuhE4pKwGu5DWDdklg5abyyyn8i/I=.1747154479',\n   \
  \ 'x-ga-ecid': '1294673677',\n    language: 'en-us',\n    screen_resolution: '1512x982',\n\
  \    event_location: { country: 'BR', region: 'SP' },\n    event_id: '101509157~103116025~103130498',\n\
  \    timestamp: 1748377016,\n    client_hints: {\n      architecture: 'arm',\n \
  \     bitness: '64',\n      full_version_list: [\n        { brand: 'Chromium', version:\
  \ '136.0.7103.93' },\n        { brand: 'Google Chrome', version: '136.0.7103.93'\
  \ },\n        { brand: 'Not.A/Brand', version: '99.0.0.0' }\n      ],\n      mobile:\
  \ false,\n      model: '',\n      platform: 'macOS',\n      platform_version: '15.2.0',\n\
  \      wow64: false,\n      brands: [\n        { brand: 'Chromium', version: '136'\
  \ },\n        { brand: 'Google Chrome', version: '136' },\n        { brand: 'Not.A/Brand',\
  \ version: '99' }\n      ]\n    },\n    'x-ga-are': '1',\n    'x-ga-mp2-frm': '0',\n\
  \    'x-ga-pscdl': 'noapi',\n    'x-ga-system_properties': { eu: [34], tu: 'BA',\
  \ ss: '1', ee: true },\n    'x-sst-system_properties': {\n      etld: 'google.com.br',\n\
  \      tft: '1747422523211',\n      lpc: '60493049',\n      navt: 'r',\n      ude:\
  \ '0',\n      sw_exp: '1',\n      request_start_time_ms: 1747422524851\n    },\n\
  \    'x-ga-request_count': 1,\n    ga_session_id: '1747422523',\n    ga_session_number:\
  \ 3,\n    'x-ga-mp2-seg': '0',\n    page_location: 'https://example.com/?test=1i23i21j3',\n\
  \    page_title: 'Example Domain',\n    event_name: 'page_view',\n    'x-ga-tfd':\
  \ 5784,\n    ip_override: '2804:14d:c096:8dd6:311c:8c00:e6c:e33',\n    user_agent:\n\
  \      'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML,\
  \ like Gecko) Chrome/136.0.0.0 Safari/537.36',\n    transaction_id: 'transactionId',\n\
  \    value: 123.45,\n    currency: 'BRL',\n    payment_type: 'card',\n    customer_type:\
  \ 'new', \n    user_id: 'userId',\n    user_data: {\n      email: { 0: 'userEmail',\
  \ 1: 'test2@example.net' },\n      phone_number: '+55 (19) 99999-9999'\n    },\n\
  \    coupon: 'coupon',\n    items: [\n      {\n        item_id: 'SKU_12345',\n \
  \       item_name: 'Stan and Friends Tee',\n        affiliation: 'Google Merchandise\
  \ Store',\n        coupon: 'SUMMER_FUN',\n        discount: 2.22,\n        index:\
  \ 0,\n        item_brand: 'Google',\n        item_category: 'Apparel|iajsdiajsd|oasodiasd',\n\
  \        item_list_id: 'related_products',\n        item_list_name: 'Related Products',\n\
  \        item_variant: 'green',\n        location_id: 'ChIJIQBpAG2ahYAR_6128GcTUEo',\n\
  \        price: 10.01,\n        quantity: 3,\n        item_group_id: 'abc'\n   \
  \   },\n      {\n        item_id: 'SKU_12346',\n        item_name: \"Google Grey\
  \ Women's (Tee)\",\n        affiliation: 'Google Merchandise Store',\n        coupon:\
  \ 'SUMMER_FUN',\n        discount: 3.33,\n        index: 1,\n        item_brand:\
  \ 'Google',\n        item_category: 'Apparel|iajsdiajsd|oasodiasd',\n        item_list_id:\
  \ 'related_products',\n        item_list_name: 'Related Products',\n        item_variant:\
  \ 'gray',\n        location_id: 'ChIJIQBpAG2ahYAR_6128GcTUEo',\n        price: 21.01,\n\
  \        promotion_id: 'P_12345',\n        promotion_name: 'Summer Sale',\n    \
  \    quantity: 2,\n        item_group_id: 'xyz'\n      }\n    ]\n  }, objToBeMerged\
  \ || {}));\n};\n\nconst expectedBigQuerySettings = {\n  logBigQueryProjectId: 'logBigQueryProjectId',\n\
  \  logBigQueryDatasetId: 'logBigQueryDatasetId',\n  logBigQueryTableId: 'logBigQueryTableId'\n\
  };\n\nconst requiredConsoleKeys = ['Type', 'TraceId', 'Name'];\nconst requiredBqKeys\
  \ = ['timestamp', 'type', 'trace_id', 'tag_name'];\nconst expectedBqOptions = {\
  \ ignoreUnknownValues: true };\n\nconst mockData = {\n  useOptimisticScenario: false,\n\
  \  adStorageConsent: 'optional',\n  logBigQueryProjectId: expectedBigQuerySettings.logBigQueryProjectId,\n\
  \  logBigQueryDatasetId: expectedBigQuerySettings.logBigQueryDatasetId,\n  logBigQueryTableId:\
  \ expectedBigQuerySettings.logBigQueryTableId\n};\n\nconst setAllMockDataByEventType\
  \ = (type, objToBeMerged) => {\n  const mockDataByEventType = {\n    pageView: {\n\
  \      type: 'pageView',\n      cookieDomain: 'auto',\n      cookieHttpOnly: false,\n\
  \      cookieSameSite: 'none',\n      cookieExpiration: '30'\n    },\n    conversion_sale:\
  \ { \n      type: 'conversion',\n      conversionType: 'sale',\n      autoMapData:\
  \ true,\n      effinityId: 'effinityId',\n      consentPerformance: true,\n    \
  \  orderOrLeadId: 'orderId',\n      value: 'value',\n      currency: 'currency',\n\
  \      voucher: 'voucher',\n      idCompteur: 'eff_cpt',\n      effiId: 'eff_sub1',\n\
  \      effiId2: 'eff_sub2',\n      prodId: 'eff_pid',\n      effiPcid: 'eff_pcid',\n\
  \      effiPcuid: 'eff_pcuid',\n      effiParam1: 'eff_pr1',\n      paymentType:\
  \ 'paymentype',\n      newCustomer: true,\n      cart: [\n        {\n          item_id:\
  \ 'SKU_12345',\n          item_name: 'Stan and Friends Tee',\n          price: 10.01,\n\
  \          quantity: 3\n        },\n        {\n          item_id: 'SKU_12346',\n\
  \          item_name: \"Google Grey Women's (Tee)\",\n          price: 21.01,\n\
  \          quantity: 2\n        }\n      ],\n      attribution: 2,\n      date:\
  \ '2025-12-31',\n      customFields: [{ name: 'ref2', value: '123' }],\n      adStorageConsent:\
  \ 'optional',\n      logType: 'debug',\n      bigQueryLogType: 'no'\n    },\n  \
  \  conversion_lead: {\n      type: 'conversion',\n      conversionType: 'lead',\n\
  \      autoMapData: true,\n      effinityId: 'effinityId',\n      consentPerformance:\
  \ true,\n      orderOrLeadId: 'leadId',\n      idCompteur: 'eff_cpt',\n      effiId:\
  \ 'eff_sub1',\n      effiId2: 'eff_sub2',\n      prodId: 'eff_pid',\n      effiPcid:\
  \ 'eff_pcid',\n      effiPcuid: 'eff_pcuid',\n      effiParam1: 'eff_pr1',\n   \
  \   attribution: 2,\n      date: '2025-12-31',\n      customFields: [{ name: 'ref2',\
  \ value: '123' }],\n      adStorageConsent: 'optional',\n      logType: 'debug',\n\
  \      bigQueryLogType: 'no'\n    }\n  };\n  \n  mergeObj(mockDataByEventType[type],\
  \ objToBeMerged || {});\n  mergeObj(mockData, mockDataByEventType[type]);\n  return\
  \ mockData;\n};\n\nmock('sendHttpRequest', (requestUrl, callback, requestOptions,\
  \ requestBody) => {\n  if (typeof callback === 'function') {\n    callback(200);\n\
  \  } else {\n    requestBody = requestOptions;\n    requestOptions = callback;\n\
  \    return Promise.create((resolve, reject) => {\n      resolve({ statusCode: 200\
  \ });\n    });  \n  }\n});\n\nmock('getRequestHeader', (header) => {\n  if (header\
  \ === 'trace-id') return 'expectedTraceId';\n});\n\nmock('getTimestampMillis', 1747945830456);\n\
  \nmock('generateRandom', 123456789);"


___NOTES___

Created on 7/31/2025, 6:02:27 PM


